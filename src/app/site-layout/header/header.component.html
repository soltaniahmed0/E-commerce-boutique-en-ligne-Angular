<!-- Modern Navigation -->
<nav class="navbar navbar-expand-lg navbar-dark bg-gradient-primary sticky-top">
  <div class="container">
    <!-- Brand -->
    <a class="navbar-brand fw-bold" href="products">
      <i class="bi bi-shop me-2"></i>
      <span class="brand-text">Soltani Fashion</span>
    </a>

    <!-- Mobile toggle -->
    <button class="navbar-toggler border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <!-- Navigation items -->
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav me-auto">
        <li class="nav-item">
          <a class="nav-link" routerLink="/products" routerLinkActive="active">
            <i class="bi bi-house me-1"></i>Home
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" routerLink="/contact">
            <i class="bi bi-envelope me-1"></i>Contact
          </a>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            <i class="bi bi-grid me-1"></i>Categories
          </a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" routerLink="/products">All Products</a></li>
            <li><a class="dropdown-item" routerLink="/products/categories/2">Men's Fashion</a></li>
            <li><a class="dropdown-item" routerLink="/products/categories/3">Women's Fashion</a></li>
            <li><a class="dropdown-item" routerLink="/products/categories/4">Kids' Fashion</a></li>
          </ul>
        </li>
      </ul>

      <!-- Enhanced Search bar -->
      <div class="search-container me-3">
        <form class="d-flex" role="search" (ngSubmit)="onSearch($event)">
          <div class="input-group search-input-group">
            <input class="form-control search-input" type="search" placeholder="Search products, brands, categories..." 
                   aria-label="Search" [(ngModel)]="searchQuery" name="searchQuery"
                   (input)="onSearchInput($event)" (focus)="showSuggestions = true" (blur)="hideSuggestions()">
            <button class="btn btn-outline-light search-btn" type="submit">
              <i class="bi bi-search"></i>
            </button>
          </div>
        </form>
        
        <!-- Search Suggestions Dropdown -->
        <div class="search-suggestions" *ngIf="showSuggestions && searchSuggestions.length > 0">
          <div class="suggestion-item" *ngFor="let suggestion of searchSuggestions" 
               (click)="selectSuggestion(suggestion)">
            <i class="bi bi-search me-2"></i>
            <span>{{suggestion}}</span>
          </div>
        </div>
        
        <!-- Recent Searches -->
        <div class="recent-searches" *ngIf="showSuggestions && recentSearches.length > 0 && !searchQuery">
          <div class="recent-header">
            <small class="text-muted">Recent Searches</small>
            <button class="btn btn-sm btn-link p-0" (click)="clearRecentSearches()">Clear</button>
          </div>
          <div class="recent-item" *ngFor="let recent of recentSearches" 
               (click)="selectSuggestion(recent)">
            <i class="bi bi-clock me-2"></i>
            <span>{{recent}}</span>
          </div>
        </div>
      </div>

      <!-- User actions -->
      <div class="d-flex align-items-center gap-3">
        <!-- Theme Toggle -->
        <button class="btn btn-outline-light theme-toggle" type="button" (click)="toggleTheme()" 
                [title]="isDarkMode ? 'Switch to Light Mode' : 'Switch to Dark Mode'">
          <i class="bi" [class.bi-sun]="!isDarkMode" [class.bi-moon]="isDarkMode"></i>
        </button>

        <!-- User greeting -->
        <span class="text-light fw-medium" *ngIf="connName">
          <i class="bi bi-person-circle me-1"></i>Hello, {{connName}}
        </span>

        <!-- Wishlist -->
        <button class="btn btn-outline-light position-relative" type="button" routerLink="/wishlist">
          <i class="bi bi-heart"></i>
          <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
            {{getWishlistCount()}}
          </span>
        </button>

        <!-- Shopping cart -->
        <button class="btn btn-outline-light position-relative" type="button" routerLink="/order">
          <i class="bi bi-cart3"></i>
          <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" *ngIf="p > 0">
            {{p}}
          </span>
        </button>

        <!-- Login/Logout -->
        <button class="btn btn-light" type="button" 
                (click)="connName ? logout() : navigateToLogin()">
          <i class="bi bi-person me-1"></i>
          {{ !connName ? 'Login' : 'Logout' }}
        </button>
      </div>
    </div>
  </div>
</nav>
